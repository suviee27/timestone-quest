<!DOCTYPE html>
<html lang="en">
<head>
  <meta charset="UTF-8">
  <meta name="viewport" content="width=device-width, initial-scale=1.0">
  <title>타임스톤 퀘스트</title>
  <script src="https://cdnjs.cloudflare.com/ajax/libs/html2canvas/1.4.1/html2canvas.min.js"></script>
  <style>
    body {
      font-family: Arial, sans-serif;
      margin: 0;
      padding: 0;
      background-color: #f4f4f4;
      display: flex;
      justify-content: center;
      align-items: center;
      height: 100vh;
    }
    .container {
      width: 90%;
      max-width: 600px;
      background: #fff;
      border-radius: 10px;
      box-shadow: 0 0 10px rgba(0, 0, 0, 0.1);
      padding: 20px;
      text-align: center;
      display: none;
      position: relative;
    }
    .visible {
      display: block;
    }
    button {
      padding: 10px 20px;
      font-size: 16px;
      margin: 10px;
      cursor: pointer;
      background-color: #007bff;
      color: white;
      border: none;
      border-radius: 5px;
    }
    button:hover {
      background-color: #0056b3;
    }
    .nav-button {
      position: absolute;
      top: 10px;
      font-size: 14px;
      color: #007bff;
      background: none;
      border: none;
      cursor: pointer;
    }
    .nav-button:hover {
      text-decoration: underline;
    }
    .home-btn {
      left: 10px;
    }
    .hint-btn {
      right: 10px;
    }
    .hint {
      margin: 20px 0;
      font-size: 14px;
      color: red;
    }
    .hint-count {
      font-weight: bold;
    }
    .footer-buttons {
      margin-top: 20px;
    }
    .final-screen {
      text-align: center;
      margin-top: 20px;
    }
  </style>
</head>
<body>
  <!-- 프롤로그 -->
  <div class="container visible" id="prologue">
    <h1>타임스톤 퀘스트</h1>
    <p>✨ 무슨 일이 일어난 걸까요? 🌟</p>
    <p>국립중앙박물관 '역사의 길'에서 놀라운 일이 벌어졌습니다.</p>
    <p>‘타임스톤’에 균열이 생겼고, 여러분은 이를 복원해야 합니다!</p>
    <div class="footer-buttons">
      <button onclick="startGame()">게임 시작</button>
    </div>
  </div>

  <!-- 임무 개요 -->
  <div class="container" id="mission">
    <button class="nav-button home-btn" onclick="goHome()">홈</button>
    <h2>임무 개요</h2>
    <p>🔍 조사: 5개의 전시실에서 타임스톤 조각을 찾으세요!</p>
    <p>💡 힌트는 총 5번만 사용할 수 있습니다.</p>
    <p>⌛️ 제한시간: 1시간 30분</p>
    <div class="footer-buttons">
      <button onclick="nextStep('zone1-intro')">게임 시작</button>
    </div>
  </div>

<!-- 구역 1: 중근세관 -->
  <div class="container" id="zone1-intro">
    <!-- 홈 버튼 -->
    <button class="nav-button home-btn" onclick="goHome()">홈</button>
    <!-- ? 버튼 -->
    <button class="nav-button hint-btn" onclick="toggleMap()">?</button>
    <h2>구역 1: 중근세관</h2>
    <p>중근세관으로 이동하세요.</p>
    <!-- 약도 이미지 (초기에 숨김 상태) -->
    <div id="map-container" style="display: none; margin-top: 20px;">
      <img src="map-image.jpg" alt="중근세관 약도" style="max-width: 100%; border: 1px solid #ddd; border-radius: 8px;">
    </div>
    <div class="footer-buttons">
      <button onclick="previousStep('mission')">이전</button>
      <button onclick="nextStep('zone1-clue')">다음</button>
    </div>
  </div>

  <script>
    // 약도 이미지 표시/숨김 전환 함수
    function toggleMap() {
      const mapContainer = document.getElementById('map-container');
      if (mapContainer.style.display === 'none') {
        mapContainer.style.display = 'block'; // 약도 표시
      } else {
        mapContainer.style.display = 'none'; // 약도 숨김
      }
    }
  </script>

  <div class="container" id="zone1-clue">
    <button class="nav-button home-btn" onclick="goHome()">홈</button>
    <button class="nav-button hint-btn" onclick="useHint('zone1-hint')">?</button>
    <h2>단서</h2>
    <p>박물관 관리인의 일기장에서 발견한 메모:</p>
    <p>"오늘도 그 백자청화 항아리를 한참 동안 바라보았다. 하얀 도자기에 푸른빛으로 그려진 그림이 참 신비롭다. 꽃이 만개한 나뭇가지에 새들이 앉아있는 모습이 너무나 생생해서 한참을 넋을 잃고 보았지."</p>
    <div id="zone1-hint" class="hint" style="display: none;">
      <p>1️⃣ 조선시대 도자기실 중앙에 있는 커다란 전시장을 살펴보세요.</p>
      <p>2️⃣ 푸른색과 하얀색이 어우러진 큰 항아리를 찾아보세요.</p>
      <p>3️⃣ 새 두 마리와 꽃나무가 함께 그려진 작품을 찾아보세요.</p>
    </div>
    <div class="footer-buttons">
      <button onclick="previousStep('zone1-intro')">이전</button>
      <button onclick="nextStep('zone1-question')">다음</button>
    </div>
  </div>

  <div class="container" id="zone1-question">
    <button class="nav-button home-btn" onclick="goHome()">홈</button>
    <button class="nav-button hint-btn" onclick="useHint('zone1-question-hint')">?</button>
    <h2>질문</h2>
    <p>이 항아리에 가장 많이 그려진 꽃은 무엇일까요?</p>
    <input type="text" id="zone1-answer" placeholder="정답 입력">
    <div class="footer-buttons">
      <button onclick="previousStep('zone1-clue')">이전</button>
      <button onclick="checkAnswer('zone1-answer', '매화', 'zone1-correct', 'zone1-question-wrong')">제출</button>
    </div>
    <p id="zone1-question-wrong" class="hint" style="display: none; color: red;">틀렸습니다! 다시 시도해 보세요.</p>
    <div id="zone1-question-hint" class="hint" style="display: none;">
      <p>힌트: 눈 속에서도 피어나는 꽃이에요. 사군자 중 하나랍니다. ㅁㅎ로 시작하는 두 글자예요.</p>
    </div>
  </div>

  <div class="container" id="zone1-correct">
    <button class="nav-button home-btn" onclick="goHome()">홈</button>
    <h2>축하합니다! 🎉</h2>
    <p>타임스톤의 푸른 조각을 찾았습니다!</p>
    <p>우리가 찾은 보물은 '백자 청화 매화 대나무 새 무늬 항아리'(국보 제170호)예요. 매화는 추운 겨울에도 피어나는 꽃으로, 고결한 절개와 선비정신을 상징해 조선 선비들이 가장 사랑했던 문양이랍니다.</p>
    <div class="footer-buttons">
      <button onclick="nextStep('zone2-intro')">다음 구역으로 이동</button>
    </div>
  </div>

<!-- 구역 2: 선사고대관 -->
<div class="container" id="zone2-intro">
  <!-- 홈 버튼 -->
  <button class="nav-button home-btn" onclick="goHome()">홈</button>
  <!-- ? 버튼 -->
  <button class="nav-button hint-btn" onclick="toggleMap()">?</button>
  <h2>구역 2: 선사고대관</h2>
  <p>선사고대관으로 이동하세요.</p>
  <!-- 약도 이미지 (초기에 숨김 상태) -->
  <div id="map-container-zone2" style="display: none; margin-top: 20px;">
    <img src="map-image-zone2.jpg" alt="선사고대관 약도" style="max-width: 100%; border: 1px solid #ddd; border-radius: 8px;">
  </div>
  <div class="footer-buttons">
    <button onclick="previousStep('zone1-correct')">이전</button>
    <button onclick="nextStep('zone2-clue')">다음</button>
  </div>
</div>

<script>
  // 약도 이미지 표시/숨김 전환 함수
  function toggleMap() {
    const mapContainer = document.getElementById('map-container-zone2');
    if (mapContainer.style.display === 'none') {
      mapContainer.style.display = 'block'; // 약도 표시
    } else {
      mapContainer.style.display = 'none'; // 약도 숨김
    }
  }
</script>

<div class="container" id="zone2-clue">
  <button class="nav-button home-btn" onclick="goHome()">홈</button>
  <button class="nav-button hint-btn" onclick="useHint('zone2-hint')">?</button>
  <h2>단서</h2>
  <p>밤 순찰 경비원들의 대화 녹음:</p>
  <p>"어젯밤, 전시실 안쪽에서 이상한 걸 봤어. 그 높게 세워진 금관에서 노란빛이 새어나왔어. 양옆에 늘어진 장식이 흔들리는데, 마치 별빛 아래 사슴이 숲을 다니는 것 같았어. 그러다 왕관 안의 초록빛이 새어나와 금빛 허리띠에까지 퍼지다 사라졌어... 뭔가 숨겨진 것 같아."</p>
  <div id="zone2-hint" class="hint" style="display: none;">
    <p>1️⃣ 금관실에서 가장 화려하고 큰 금관을 찾아보세요.</p>
    <p>2️⃣ 사슴뿔 모양의 장식이 특징적인 금관이에요.</p>
    <p>3️⃣ 수식(垂飾)이라 부르는 긴 장식들이 양옆으로 늘어져 있어요.</p>
  </div>
  <div class="footer-buttons">
    <button onclick="previousStep('zone2-intro')">이전</button>
    <button onclick="nextStep('zone2-question')">다음</button>
  </div>
</div>

<div class="container" id="zone2-question">
  <button class="nav-button home-btn" onclick="goHome()">홈</button>
  <button class="nav-button hint-btn" onclick="useHint('zone2-question-hint')">?</button>
  <h2>질문</h2>
  <p>금관의 양쪽으로 늘어진 수식의 개수에 비밀이 숨겨져 있어요. 이 숫자를 입력하면 조각을 찾을 수 있을 거예요!</p>
  <input type="text" id="zone2-answer" placeholder="정답 입력">
  <div class="footer-buttons">
    <button onclick="previousStep('zone2-clue')">이전</button>
    <button onclick="checkAnswer('zone2-answer', '6', 'zone2-correct', 'zone2-question-wrong')">제출</button>
  </div>
  <p id="zone2-question-wrong" class="hint" style="display: none; color: red;">틀렸습니다! 다시 시도해 보세요.</p>
  <div id="zone2-question-hint" class="hint" style="display: none;">
    <p>힌트: 주사위의 면의 수와 같아요. 좌우 대칭으로 한쪽에 3개가 달려있어요.</p>
  </div>
</div>

<div class="container" id="zone2-correct">
  <button class="nav-button home-btn" onclick="goHome()">홈</button>
  <h2>축하합니다! 🎉</h2>
  <p>타임스톤의 노란 조각을 찾았습니다!</p>
  <p>우리가 발견한 보물은 **황남대총 북분 금관**(국보 제191호)입니다. 이 금관은 신라 왕비의 무덤으로 추정되는 황남대총에서 출토된 것으로, 여성이 사용했던 것으로 보입니다. 특히 사슴뿔 모양 장식(녹각형 입식)은 고대 북방계 문화와 연결되며, 신라 금관의 독특한 무속적 성격을 보여줍니다. 양옆에 늘어진 수식(垂飾)은 걸을 때마다 반짝이며 왕비의 신성함과 권위를 상징했답니다.</p>
  <div class="footer-buttons">
    <button onclick="nextStep('zone3-intro')">다음 구역으로 이동</button>
  </div>
</div>

<!-- 구역 3: 서화관 -->
<div class="container" id="zone3-intro">
  <!-- 홈 버튼 -->
  <button class="nav-button home-btn" onclick="goHome()">홈</button>
  <!-- ? 버튼 -->
  <button class="nav-button hint-btn" onclick="toggleMap()">?</button>
  <h2>구역 3: 서화관</h2>
  <p>서화관으로 이동하세요.</p>
  <!-- 약도 이미지 (초기에 숨김 상태) -->
  <div id="map-container-zone3" style="display: none; margin-top: 20px;">
    <img src="map-image-zone3.jpg" alt="서화관 약도" style="max-width: 100%; border: 1px solid #ddd; border-radius: 8px;">
  </div>
  <div class="footer-buttons">
    <button onclick="previousStep('zone2-correct')">이전</button>
    <button onclick="nextStep('zone3-clue')">다음</button>
  </div>
</div>

<script>
  // 약도 이미지 표시/숨김 전환 함수
  function toggleMap() {
    const mapContainer = document.getElementById('map-container-zone3');
    if (mapContainer.style.display === 'none') {
      mapContainer.style.display = 'block'; // 약도 표시
    } else {
      mapContainer.style.display = 'none'; // 약도 숨김
    }
  }
</script>

<div class="container" id="zone3-clue">
  <button class="nav-button home-btn" onclick="goHome()">홈</button>
  <button class="nav-button hint-btn" onclick="useHint('zone3-hint')">?</button>
  <h2>단서</h2>
  <p>학예사의 기록:</p>
  <p>"왕의서고에서 이상한 일이 발생했다. 의궤들이 보관된 서가에서 초록빛이 새어나왔는데, 그 빛이 비추는 곳마다 과거의 장면이 살아났다. 프랑스 군인들이 의궤를 약탈하는 모습, 긴 항해... 그리고 마지막으로 최근 본국으로 돌아오는 순간까지..."</p>
  <div id="zone3-hint" class="hint" style="display: none;">
    <p>1️⃣ '왕의서고' 전시실에서 가장 중요한 유물을 찾아보세요.</p>
    <p>2️⃣ 조선시대 왕실 의례를 기록한 책들이에요.</p>
    <p>3️⃣ 프랑스가 가져갔다가 우리나라로 돌아온 특별한 책들이에요.</p>
  </div>
  <div class="footer-buttons">
    <button onclick="previousStep('zone3-intro')">이전</button>
    <button onclick="nextStep('zone3-question')">다음</button>
  </div>
</div>

<div class="container" id="zone3-question">
  <button class="nav-button home-btn" onclick="goHome()">홈</button>
  <button class="nav-button hint-btn" onclick="useHint('zone3-question-hint')">?</button>
  <h2>질문</h2>
  <p>왕의서고에 전시된 의궤들 중 닫혀있는 의궤의 표지의 재료는 무엇인가요? 재료의 이름이 조각을 찾는 열쇠가 될 거예요.</p>
  <input type="text" id="zone3-answer" placeholder="정답 입력">
  <div class="footer-buttons">
    <button onclick="previousStep('zone3-clue')">이전</button>
    <button onclick="checkAnswer('zone3-answer', '비단', 'zone3-correct', 'zone3-question-wrong')">제출</button>
  </div>
  <p id="zone3-question-wrong" class="hint" style="display: none; color: red;">틀렸습니다! 다시 시도해 보세요.</p>
  <div id="zone3-question-hint" class="hint" style="display: none;">
    <p>힌트: 왕실에서만 사용하던 진한 초록색 직물이에요. 옛날 신부님들의 혼수 1순위였죠. 누에고치에서 뽑은 실로 만든 최고급 직물이에요.</p>
  </div>
</div>

<div class="container" id="zone3-correct">
  <button class="nav-button home-btn" onclick="goHome()">홈</button>
  <h2>축하합니다! 🎉</h2>
  <p>타임스톤의 초록 조각을 찾았습니다!</p>
  <p>우리가 발견한 보물은 **외규장각 의궤**입니다. 조선왕실 문화의 보고인 이 의궤들은 1866년 병인양요 때 프랑스군이 강화도에서 약탈해 갔다가 145년 만인 2011년에 우리나라로 귀환했어요. 지금 보고 있는 의궤는 책의의 원형이 그대로 남아있는 11책 중 하나로, 초록 비단으로 만든 표지에 다양한 문양이 수놓아져 있어요. 이 귀중한 의궤들은 3개월마다 교체 전시되고 있답니다.</p>
  <div class="footer-buttons">
    <button onclick="nextStep('zone4-intro')">다음 구역으로 이동</button>
  </div>
</div>

<!-- 구역 4: 조각공예관 -->
<div class="container" id="zone4-intro">
  <!-- 홈 버튼 -->
  <button class="nav-button home-btn" onclick="goHome()">홈</button>
  <!-- ? 버튼 -->
  <button class="nav-button hint-btn" onclick="toggleMap()">?</button>
  <h2>구역 4: 조각공예관</h2>
  <p>조각공예관으로 이동하세요.</p>
  <!-- 약도 이미지 (초기에 숨김 상태) -->
  <div id="map-container-zone4" style="display: none; margin-top: 20px;">
    <img src="map-image-zone4.jpg" alt="조각공예관 약도" style="max-width: 100%; border: 1px solid #ddd; border-radius: 8px;">
  </div>
  <div class="footer-buttons">
    <button onclick="previousStep('zone3-correct')">이전</button>
    <button onclick="nextStep('zone4-clue')">다음</button>
  </div>
</div>

<script>
  // 약도 이미지 표시/숨김 전환 함수
  function toggleMap() {
    const mapContainer = document.getElementById('map-container-zone4');
    if (mapContainer.style.display === 'none') {
      mapContainer.style.display = 'block'; // 약도 표시
    } else {
      mapContainer.style.display = 'none'; // 약도 숨김
    }
  }
</script>

<div class="container" id="zone4-clue">
  <button class="nav-button home-btn" onclick="goHome()">홈</button>
  <button class="nav-button hint-btn" onclick="useHint('zone4-hint')">?</button>
  <h2>단서</h2>
  <p>조선후기에 발견된 어느 기록:</p>
  <p>"... 오늘 밤, 휘영청 밝은 달빛 아래 가마 앞에서... 하얀 보름달 같은 항아리에서 신비한 기운이 피어올랐다... 보라빛이 은은하게 퍼져나가더니... 마치 하늘의 달처럼 고요히 빛나는구나..."</p>
  <div id="zone4-hint" class="hint" style="display: none;">
    <p>1️⃣ 조선백자실에서 가장 크고 우아한 곡선을 가진 항아리를 찾아보세요.</p>
    <p>2️⃣ 보름달처럼 둥근 형태가 특징이에요.</p>
    <p>3️⃣ 표면에 자연스러운 균열이 있는 큰 하얀 항아리예요.</p>
  </div>
  <div class="footer-buttons">
    <button onclick="previousStep('zone4-intro')">이전</button>
    <button onclick="nextStep('zone4-question')">다음</button>
  </div>
</div>

<div class="container" id="zone4-question">
  <button class="nav-button home-btn" onclick="goHome()">홈</button>
  <button class="nav-button hint-btn" onclick="useHint('zone4-question-hint')">?</button>
  <h2>질문</h2>
  <p>조각을 찾기 위해서는 이 항아리의 모양이 닮은 천체의 위상 중 가장 완벽한 순간을 찾아야 해요. 달의 모양을 한글로 쓰면 조각이 나타날 거예요!</p>
  <input type="text" id="zone4-answer" placeholder="정답 입력">
  <div class="footer-buttons">
    <button onclick="previousStep('zone4-clue')">이전</button>
    <button onclick="checkAnswer('zone4-answer', '보름', 'zone4-correct', 'zone4-question-wrong')">제출</button>
  </div>
  <p id="zone4-question-wrong" class="hint" style="display: none; color: red;">틀렸습니다! 다시 시도해 보세요.</p>
  <div id="zone4-question-hint" class="hint" style="display: none;">
    <p>힌트: 달이 가장 크고 환하게 보이는 때예요. 음력 15일에 볼 수 있어요. ㅂㄹ로 시작하는 두 글자예요.</p>
  </div>
</div>

<div class="container" id="zone4-correct">
  <button class="nav-button home-btn" onclick="goHome()">홈</button>
  <h2>축하합니다! 🎉</h2>
  <p>타임스톤의 보라 조각을 찾았습니다!</p>
  <p>우리가 발견한 보물은 **백자 달항아리**(보물 제1437호)입니다. 조선 후기를 대표하는 이 달항아리는 위아래를 따로 만들어 접합한 특별한 제작 방식으로 만들어졌어요. 완벽한 원형을 추구하지 않고 자연스러운 찌그러짐과 균열을 받아들인 것에서 조선 도공들의 여유로운 미의식을 엿볼 수 있답니다. 보름달처럼 둥근 형태는 조선 시대 사람들의 순수하고 소박한 미의식을 대표하는 걸작이에요.</p>
  <div class="footer-buttons">
    <button onclick="nextStep('end-screen')">게임 종료</button>
  </div>
</div>

<!-- 종료 페이지 -->
<div class="container" id="end-screen">
  <h1>🎉 축하합니다! 🎉</h1>
  <p>타임스톤의 모든 조각을 찾아 복원했습니다! 🏆</p>
  <div class="final-details">
    <p><strong>게임 시작 시간:</strong> <span id="start-time"></span></p>
    <p><strong>성공 시간:</strong> <span id="end-time"></span></p>
    <p><strong>총 걸린 시간:</strong> <span id="total-time"></span></p>
  </div>
  <button onclick="saveScreenshot()">📸 스크린샷 저장</button>
</div>

<script>
  // 예시: 게임 시작 시간과 성공 시간 설정
  const startTime = new Date(); // 예시로 현재 시간을 게임 시작 시간으로 설정
  const endTime = new Date(startTime.getTime() + 5400000); // 예시로 1시간 30분 후를 성공 시간으로 설정

  // 시간 표시
  document.getElementById("start-time").innerText = startTime.toLocaleTimeString();
  document.getElementById("end-time").innerText = endTime.toLocaleTimeString();

  // 총 걸린 시간 계산 (시:분:초 형식)
  const totalTimeMs = endTime - startTime; // 밀리초 단위로 시간 차 계산
  const totalMinutes = Math.floor(totalTimeMs / (1000 * 60)); // 총 분 계산
  const totalSeconds = Math.floor((totalTimeMs % (1000 * 60)) / 1000); // 남은 초 계산
  const totalHours = Math.floor(totalMinutes / 60); // 시간 계산
  const displayMinutes = totalMinutes % 60; // 남은 분 계산

  // 총 걸린 시간 표시
  document.getElementById("total-time").innerText = `${totalHours}시간 ${displayMinutes}분 ${totalSeconds}초`;

  // 스크린샷 저장 기능
  function saveScreenshot() {
    html2canvas(document.body).then(canvas => {
      const link = document.createElement('a');
      link.download = '타임스톤_퀘스트_성공.png'; // 저장될 파일 이름
      link.href = canvas.toDataURL();
      link.click();
    });
  }
</script>
</body>
</html>