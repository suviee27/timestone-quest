<!DOCTYPE html>
<html lang="ko">
<head>
  <meta charset="UTF-8">
  <meta name="viewport" content="width=device-width, initial-scale=1.0">
  <title>ìŠ¤í†¤ ê²°ê³¼</title>
  <link rel="stylesheet" href="main.css">
  <script src="https://cdn.jsdelivr.net/npm/html2canvas@1.4.1/dist/html2canvas.min.js"></script>
  <style>
    .hidden {
      display: none;
    }
    .screenshot-target {
      margin-bottom: 20px;
      padding: 20px;
      background-color: #f8f9fa;
      border-radius: 8px;
      text-align: center;
      position: relative;
    }
    .team-name-display {
      margin-top: 10px;
      font-size: 18px;
      font-weight: bold;
      color: #333;
    }
  </style>
</head>
<body>
  <div class="container">
    <!-- 1A ìŠ¤í†¤ ê²°ê³¼ -->
    <div id="1A-result" class="result">
      <div class="screenshot-target">
        <h2>ì¶•í•˜í•©ë‹ˆë‹¤! ğŸ‰</h2>
        <p>íƒ€ì„ìŠ¤í†¤ì˜ <strong>ë…¸ë€</strong> ì¡°ê°ì„ íšë“í–ˆìŠµë‹ˆë‹¤!</p>
        <img src="yellow-stone.png" alt="ë…¸ë€ ìŠ¤í†¤">
        <!-- ë™ì ìœ¼ë¡œ íŒ€ ì´ë¦„ì„ í‘œì‹œí•  ìœ„ì¹˜ -->
        <p id="team-name-display" class="team-name-display"></p>
      </div>
      <div class="input-container">
        <input type="text" id="team-name" placeholder="íŒ€ ì´ë¦„ì„ ì…ë ¥í•˜ì„¸ìš”">
        <button id="download-btn">ìŠ¤í¬ë¦°ìƒ· ë‹¤ìš´ë°›ê¸°</button>
      </div>
      <button class="secondary-btn" onclick="location.href='clue-list.html'">ëª©ë¡ìœ¼ë¡œ ëŒì•„ê°€ê¸°</button>
    </div>
  </div>

  <script>
    // ìŠ¤í¬ë¦°ìƒ· ìº¡ì²˜ ë° ë‹¤ìš´ë¡œë“œ í•¨ìˆ˜
    async function downloadScreenshot() {
      const teamNameInput = document.getElementById('team-name');
      const teamNameDisplay = document.getElementById('team-name-display');
      const teamName = teamNameInput.value.trim();

      if (!teamName) {
        alert('íŒ€ ì´ë¦„ì„ ì…ë ¥í•´ì£¼ì„¸ìš”.');
        return;
      }

      // íŒ€ ì´ë¦„ì„ ìŠ¤í¬ë¦°ìƒ· ì˜ì—­ì— í‘œì‹œ
      teamNameDisplay.textContent = `íŒ€ ì´ë¦„: ${teamName}`;

      // ìŠ¤í¬ë¦°ìƒ· ìº¡ì²˜ ëŒ€ìƒ ì„¤ì •
      const target = document.querySelector('.screenshot-target');

      // html2canvasë¡œ ìŠ¤í¬ë¦°ìƒ· ìƒì„±
      const canvas = await html2canvas(target);

      // ì´ë¯¸ì§€ URL ìƒì„±
      const image = canvas.toDataURL('image/png');
      const link = document.createElement('a');
      link.href = image;
      link.download = `${teamName}-stone.png`; // íŒŒì¼ ì´ë¦„
      link.click(); // ë‹¤ìš´ë¡œë“œ ì‹¤í–‰

      // ê²°ê³¼ ìë™ ì œì¶œ
      submitResult('ë…¸ë€ ìŠ¤í†¤', teamName);
    }

    // ê²°ê³¼ ì œì¶œ í•¨ìˆ˜ (ë¡œì»¬ ìŠ¤í† ë¦¬ì§€ì— ì €ì¥)
    function submitResult(stoneName, teamName) {
      // í˜„ì¬ ì‹œê°„ ê°€ì ¸ì˜¤ê¸°
      const currentTime = new Date().toLocaleString();

      // ê²°ê³¼ ê°ì²´ ìƒì„±
      const result = { team: teamName, stone: stoneName, time: currentTime };

      // ê¸°ì¡´ ê²°ê³¼ ê°€ì ¸ì˜¤ê¸° ë° ì¶”ê°€
      const results = JSON.parse(localStorage.getItem('results')) || [];
      results.push(result);
      localStorage.setItem('results', JSON.stringify(results)); // ì €ì¥

      alert('ê²°ê³¼ê°€ ì„±ê³µì ìœ¼ë¡œ ì œì¶œë˜ì—ˆìŠµë‹ˆë‹¤!');
    }

    // ë²„íŠ¼ í´ë¦­ ì´ë²¤íŠ¸ ì—°ê²°
    document.getElementById('download-btn').addEventListener('click', downloadScreenshot);
  </script>
</body>
</html>